<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>마트 AI 요리 도우미</title>
</head>
<body>

<!-- 메인 화면 -->
<div id="main-screen">
    <h2>마트 AI 요리 도우미</h2>
    <hr>
    <p>뭘 도와드릴까요?</p>
    <br>
    
    <fieldset>
        <legend>일반 검색</legend>
        <button onclick="goTo('recommend-screen')">요리추천</button>
        <br><br>
        <button onclick="goTo('recipe-screen')">레시피검색</button>
    </fieldset>
    <br>
    <fieldset>
        <legend>스마트 추천</legend>
        <button onclick="goTo('discount-screen')">할인상품으로 뭐 해먹지?</button>
        <br><br>
        <button onclick="goTo('fridge-screen')">냉장고 털기</button>
    </fieldset>
    
    <hr>
    <p>또는 직접 물어보세요:</p>
    <input type="text" id="main-input" size="30" placeholder="예: 삼겹살로 뭐 해먹지?">
    <button onclick="handleMainInput()">보내기</button>
</div>

<!-- 요리추천 화면 -->
<div id="recommend-screen" hidden>
    <h2>요리추천</h2>
    <hr>
    <p>어떤 종류의 요리를 원하세요?</p>
    <br>
    <label><input type="checkbox" name="category" value="한식"> 한식</label>
    <label><input type="checkbox" name="category" value="중식"> 중식</label>
    <label><input type="checkbox" name="category" value="일식"> 일식</label>
    <label><input type="checkbox" name="category" value="양식"> 양식</label>
    <br><br>
    <input type="text" id="recommend-input" size="30" placeholder="원하는 조건 입력 (예: 간단한 저녁)">
    <button onclick="showRecommendResult()">추천받기</button>
    <br><br>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 레시피 검색 화면 -->
<div id="recipe-screen" hidden>
    <h2>레시피 검색</h2>
    <hr>
    <p>어떤 요리를 찾으세요?</p>
    <br>
    <input type="text" id="recipe-input" size="30" placeholder="요리명 입력 (예: 김치찌개)">
    <button onclick="searchRecipe()">검색</button>
    <br><br>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 할인상품 화면 -->
<div id="discount-screen" hidden>
    <h2>오늘의 할인상품</h2>
    <hr>
    <table border="1" cellpadding="8">
        <tr>
            <td>들기름 50%</td>
            <td>삼겹살 30%</td>
        </tr>
        <tr>
            <td>고추장 20%</td>
            <td>두부 1+1</td>
        </tr>
    </table>
    <br>
    <p>관심가는 상품을 선택하거나 입력하세요:</p>
    <br>
    <label><input type="checkbox" name="discount" value="들기름"> 들기름</label>
    <label><input type="checkbox" name="discount" value="삼겹살"> 삼겹살</label>
    <label><input type="checkbox" name="discount" value="고추장"> 고추장</label>
    <label><input type="checkbox" name="discount" value="두부"> 두부</label>
    <br><br>
    <input type="text" id="discount-input" size="25" placeholder="다른 할인상품 입력...">
    <button onclick="addDiscountItem()">추가</button>
    <br><br>
    <button onclick="showDiscountResult()">추천받기</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 냉장고 털기 화면 -->
<div id="fridge-screen" hidden>
    <h2>냉장고 털기</h2>
    <hr>
    <p>냉장고에 뭐 있어요? 선택하거나 입력하세요:</p>
    <br>
    <label><input type="checkbox" name="fridge" value="삼겹살"> 삼겹살</label>
    <label><input type="checkbox" name="fridge" value="대파"> 대파</label>
    <label><input type="checkbox" name="fridge" value="양파"> 양파</label>
    <label><input type="checkbox" name="fridge" value="마늘"> 마늘</label>
    <br>
    <label><input type="checkbox" name="fridge" value="계란"> 계란</label>
    <label><input type="checkbox" name="fridge" value="두부"> 두부</label>
    <label><input type="checkbox" name="fridge" value="김치"> 김치</label>
    <label><input type="checkbox" name="fridge" value="당근"> 당근</label>
    <br><br>
    <input type="text" id="fridge-input" size="25" placeholder="재료 직접 입력...">
    <button onclick="addFridgeItem()">추가</button>
    <br><br>
    <p>선택된 재료: <span id="selected-ingredients">없음</span></p>
    <br>
    <button onclick="showFridgeResult()">뭐 해먹을까?</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 요리추천 결과 -->
<div id="recommend-result" hidden>
    <h2>AI 추천</h2>
    <hr>
    <table border="1" cellpadding="10">
        <tr>
            <td>
                <p><span id="recommend-category"></span> 요리를 원하시는군요!</p>
                <br>
                <p><strong>오늘의 추천 요리:</strong></p>
                <p id="recommend-list"></p>
                <br>
                <p>할인 정보: 관련 재료 할인 중!</p>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="alert('레시피 상세 내용입니다!')">레시피 보기</button>
    <button onclick="alert('장바구니에 담았습니다!')">장바구니 담기</button>
    <br><br>
    <hr>
    <p>다른 질문이 있으신가요?</p>
    <input type="text" id="recommend-followup" size="25" placeholder="추가 질문...">
    <button onclick="handleFollowup('recommend-followup')">보내기</button>
    <br><br>
    <button onclick="goTo('recommend-screen')">다른 추천 받기</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 레시피 검색 결과 -->
<div id="recipe-result" hidden>
    <h2>AI 추천</h2>
    <hr>
    <table border="1" cellpadding="10">
        <tr>
            <td>
                <p><strong><span id="recipe-name"></span></strong> 레시피를 찾았어요!</p>
                <br>
                <p>조리시간: 30분 | 난이도: 쉬움</p>
                <br>
                <p><strong>필요한 재료:</strong></p>
                <p id="recipe-ingredients"></p>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="alert('1. 재료 손질\n2. 끓이기\n3. 간 맞추기\n4. 완성!')">레시피 보기</button>
    <button onclick="alert('장바구니에 담았습니다!')">장바구니 담기</button>
    <br><br>
    <hr>
    <p>다른 질문이 있으신가요?</p>
    <input type="text" id="recipe-followup" size="25" placeholder="추가 질문...">
    <button onclick="handleFollowup('recipe-followup')">보내기</button>
    <br><br>
    <button onclick="goTo('recipe-screen')">다른 레시피 검색</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 할인상품 결과 화면 -->
<div id="discount-result" hidden>
    <h2>AI 추천</h2>
    <hr>
    <table border="1" cellpadding="10">
        <tr>
            <td>
                <p><span id="discount-selected"></span> 선택하셨네요!</p>
                <br>
                <p><strong>비빔밥 어때요?</strong></p>
                <p>선택하신 재료로 맛있게 만들 수 있어요!</p>
                <br>
                <p>들기름 50% - 4,500원</p>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="alert('1. 밥 준비\n2. 나물 볶기\n3. 고추장 넣고 비비기\n4. 완성!')">레시피 보기</button>
    <button onclick="alert('장바구니에 담았습니다!')">장바구니 담기</button>
    <br><br>
    <hr>
    <p>다른 질문이 있으신가요?</p>
    <input type="text" id="discount-followup" size="25" placeholder="추가 질문...">
    <button onclick="handleFollowup('discount-followup')">보내기</button>
    <br><br>
    <button onclick="goTo('discount-screen')">다른 추천 받기</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 냉장고 결과 화면 -->
<div id="fridge-result" hidden>
    <h2>AI 추천</h2>
    <hr>
    <table border="1" cellpadding="10">
        <tr>
            <td>
                <p><span id="fridge-selected"></span> 있으시네요!</p>
                <br>
                <p><strong>제육볶음 어때요?</strong></p>
                <p>지금 고추장이 20% 할인이에요!</p>
                <br>
                <p>고추장 20% - 2,400원</p>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="alert('1. 고기 양념하기\n2. 야채 썰기\n3. 센 불에 볶기\n4. 완성!')">레시피 보기</button>
    <button onclick="alert('장바구니에 담았습니다!')">장바구니 담기</button>
    <br><br>
    <hr>
    <p>다른 질문이 있으신가요?</p>
    <input type="text" id="fridge-followup" size="25" placeholder="추가 질문...">
    <button onclick="handleFollowup('fridge-followup')">보내기</button>
    <br><br>
    <button onclick="goTo('fridge-screen')">다른 추천 받기</button>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<!-- 일반 채팅 결과 -->
<div id="chat-result" hidden>
    <h2>AI 추천</h2>
    <hr>
    <table border="1" cellpadding="10">
        <tr>
            <td>
                <p>"<span id="user-question"></span>" 라고 하셨네요!</p>
                <br>
                <p id="chat-response"></p>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="alert('레시피 상세 내용입니다!')">레시피 보기</button>
    <button onclick="alert('장바구니에 담았습니다!')">장바구니 담기</button>
    <br><br>
    <hr>
    <p>다른 질문이 있으신가요?</p>
    <input type="text" id="chat-followup" size="25" placeholder="추가 질문...">
    <button onclick="handleFollowup('chat-followup')">보내기</button>
    <br><br>
    <button onclick="goTo('main-screen')">처음으로</button>
</div>

<script>
function goTo(screenId) {
    document.querySelectorAll('body > div').forEach(d => d.hidden = true);
    document.getElementById(screenId).hidden = false;
}

function getChecked(name) {
    return Array.from(document.querySelectorAll('input[name="'+name+'"]:checked'))
                .map(c => c.value);
}

// 메인 입력창 처리
function handleMainInput() {
    var input = document.getElementById('main-input').value.trim();
    if (!input) { alert('질문을 입력해주세요!'); return; }
    
    document.getElementById('user-question').textContent = input;
    document.getElementById('chat-response').innerHTML = 
        '<strong>삼겹살 요리 추천드려요!</strong><br><br>' +
        '- 삼겹살 김치찌개<br>- 대패삼겹 숙주볶음<br>- 삼겹살 된장찌개<br><br>' +
        '지금 삼겹살 30% 할인 중이에요!';
    
    document.getElementById('main-input').value = '';
    goTo('chat-result');
}

// 요리추천
function showRecommendResult() {
    var categories = getChecked('category');
    var input = document.getElementById('recommend-input').value.trim();
    
    if (categories.length === 0 && !input) { 
        alert('카테고리를 선택하거나 조건을 입력해주세요!'); 
        return; 
    }
    
    var categoryText = categories.length > 0 ? categories.join(', ') : '맞춤';
    document.getElementById('recommend-category').textContent = categoryText;
    
    var recommendations = {
        '한식': '- 김치찌개<br>- 된장찌개<br>- 불고기',
        '중식': '- 짜장면<br>- 탕수육<br>- 마파두부',
        '일식': '- 돈카츠<br>- 우동<br>- 연어덮밥',
        '양식': '- 파스타<br>- 스테이크<br>- 리조또'
    };
    
    var result = categories.length > 0 ? recommendations[categories[0]] : '- 제육볶음<br>- 계란말이<br>- 김치볶음밥';
    document.getElementById('recommend-list').innerHTML = result;
    
    document.getElementById('recommend-input').value = '';
    goTo('recommend-result');
}

// 레시피 검색
function searchRecipe() {
    var input = document.getElementById('recipe-input').value.trim();
    if (!input) { alert('요리명을 입력해주세요!'); return; }
    
    var recipes = {
        '김치찌개': '김치, 돼지고기, 두부, 대파, 고춧가루',
        '된장찌개': '된장, 두부, 애호박, 감자, 대파',
        '제육볶음': '돼지고기, 고추장, 양파, 대파, 마늘'
    };
    
    document.getElementById('recipe-name').textContent = input;
    document.getElementById('recipe-ingredients').textContent = 
        recipes[input] || '돼지고기, 양파, 마늘, 간장, 설탕';
    
    document.getElementById('recipe-input').value = '';
    goTo('recipe-result');
}

// 할인상품 추가
function addDiscountItem() {
    var input = document.getElementById('discount-input');
    if (input.value.trim()) {
        var container = document.querySelector('#discount-screen');
        var br = container.querySelectorAll('br')[4];
        var label = document.createElement('label');
        label.innerHTML = '<input type="checkbox" name="discount" value="'+input.value+'" checked> '+input.value+' ';
        br.before(label);
        input.value = '';
    }
}

// 냉장고 재료 추가
function addFridgeItem() {
    var input = document.getElementById('fridge-input');
    if (input.value.trim()) {
        var container = document.querySelector('#fridge-screen');
        var br = container.querySelectorAll('br')[3];
        var label = document.createElement('label');
        label.innerHTML = '<input type="checkbox" name="fridge" value="'+input.value+'" checked> '+input.value+' ';
        br.before(label);
        label.querySelector('input').addEventListener('change', updateSelected);
        updateSelected();
        input.value = '';
    }
}

function showDiscountResult() {
    var selected = getChecked('discount');
    if (selected.length === 0) { alert('상품을 선택해주세요!'); return; }
    document.getElementById('discount-selected').textContent = selected.join(', ');
    goTo('discount-result');
}

function showFridgeResult() {
    var selected = getChecked('fridge');
    if (selected.length === 0) { alert('재료를 선택해주세요!'); return; }
    document.getElementById('fridge-selected').textContent = selected.join(', ');
    goTo('fridge-result');
}

function updateSelected() {
    var selected = getChecked('fridge');
    document.getElementById('selected-ingredients').textContent = 
        selected.length > 0 ? selected.join(', ') : '없음';
}

// 후속 질문 처리
function handleFollowup(inputId) {
    var input = document.getElementById(inputId).value.trim();
    if (!input) { alert('질문을 입력해주세요!'); return; }
    
    document.getElementById('user-question').textContent = input;
    document.getElementById('chat-response').innerHTML = 
        '좋은 질문이에요!<br><br>' +
        '추가로 <strong>파기름</strong>을 먼저 내면 더 맛있어요!<br><br>' +
        '참기름이 지금 30% 할인 중이에요!';
    
    document.getElementById(inputId).value = '';
    goTo('chat-result');
}

// 체크박스 이벤트 등록
document.querySelectorAll('input[name="fridge"]').forEach(function(cb) {
    cb.addEventListener('change', updateSelected);
});

// 엔터키 처리
document.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        var active = document.activeElement;
        if (active.id === 'main-input') handleMainInput();
        else if (active.id === 'recommend-input') showRecommendResult();
        else if (active.id === 'recipe-input') searchRecipe();
        else if (active.id === 'discount-input') addDiscountItem();
        else if (active.id === 'fridge-input') addFridgeItem();
        else if (active.id.includes('followup')) handleFollowup(active.id);
    }
});
</script>

</body>
</html>

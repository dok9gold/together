# cooking.yaml
# 요리 AI 어시스턴트 프롬프트 템플릿 (MyBatis Mapper 스타일)

classify_intent:
  description: "사용자 쿼리의 의도 분류 및 엔티티 추출"
  template: |
    당신은 요리 AI 어시스턴트의 의도 분류 및 엔티티 추출 전문가입니다.

    ## 분류 기준
    1. recipe_create: 특정 요리의 구체적인 조리법 요구
       - 키워드: "만드는 법", "레시피", "어떻게 만들어", "조리법", "요리법"

    2. recommend: 여러 음식 중 선택지 요구
       - 키워드: "추천", "뭐 먹을까", "메뉴 제안", "어떤 음식", "소개"

    3. question: 요리 관련 정보 질문
       - 키워드: "칼로리", "영양", "얼마나", "?", "뭐야", "차이"

    ## 엔티티 추출
    - dishes: 구체적 요리명 (예: ["김치찌개", "된장찌개"])
    - ingredients: 재료 (예: ["토마토", "달걀"])
    - cuisine_type: 요리 유형 (예: "한식", "양식", "일식", "중식")
    - taste: 맛 선호 (예: ["매운맛", "단맛", "짠맛"])
    - constraints: 제약조건
      - time: 시간 (예: "30분", "1시간")
      - difficulty: 난이도 (예: "쉬움", "중간", "어려움")
      - servings: 인분 (예: 2, 4)
    - dietary: 식이제한 (예: ["비건", "저염식", "글루텐프리"])
    - count: 요청 개수 (예: 3)

    ## Few-Shot 예시

    ### 예시 1: 단일 레시피
    입력: "김치찌개 만드는 법 알려줘"
    출력:
    {
        "primary_intent": "recipe_create",
        "secondary_intents": [],
        "entities": {
            "dishes": ["김치찌개"]
        },
        "confidence": 0.95
    }

    ### 예시 2: 복수 레시피
    입력: "김치찌개, 된장찌개, 순두부찌개 레시피 조회"
    출력:
    {
        "primary_intent": "recipe_create",
        "secondary_intents": [],
        "entities": {
            "dishes": ["김치찌개", "된장찌개", "순두부찌개"],
            "count": 3
        },
        "confidence": 0.95
    }

    ### 예시 3: 제약 조건 포함
    입력: "토마토와 달걀로 30분 안에 만들 수 있는 요리"
    출력:
    {
        "primary_intent": "recipe_create",
        "secondary_intents": [],
        "entities": {
            "ingredients": ["토마토", "달걀"],
            "constraints": {"time": "30분"}
        },
        "confidence": 0.9
    }

    ### 예시 4: 추천
    입력: "매운 한식 추천해줘"
    출력:
    {
        "primary_intent": "recommend",
        "secondary_intents": [],
        "entities": {
            "cuisine_type": "한식",
            "taste": ["매운맛"],
            "count": 3
        },
        "confidence": 0.9
    }

    ### 예시 5: 복합 의도 (추천 + 레시피)
    입력: "매운 음식 추천해서 그 중 하나 레시피도 보여줘"
    출력:
    {
        "primary_intent": "recommend",
        "secondary_intents": ["recipe_create"],
        "entities": {
            "taste": ["매운맛"],
            "count": 3
        },
        "confidence": 0.85
    }

    ### 예시 6: 질문
    입력: "김치찌개 칼로리 얼마야?"
    출력:
    {
        "primary_intent": "question",
        "secondary_intents": [],
        "entities": {
            "dishes": ["김치찌개"]
        },
        "confidence": 0.95
    }

    ## 주의사항
    - 복합 의도는 primary_intent + secondary_intents 사용
    - confidence는 0.0~1.0 (0.7 이하면 애매함)
    - 애매하면 가장 핵심적인 의도 선택
    - entities는 추출 가능한 것만 포함 (없으면 빈 객체)

    ## 현재 사용자 입력
    입력: "{{ query }}"

    위 기준과 예시에 따라 JSON으로 분류하세요:

generate_recipe_single:
  description: "단일 레시피 생성"
  template: |
    사용자가 "{{ query }}"를 요청했습니다.

    {% if dishes %}
    요리명: {{ dishes | join(', ') }}
    {% endif %}
    {% if ingredients %}
    사용 재료: {{ ingredients | join(', ') }}
    {% endif %}
    {% if constraints %}
    제약 조건: {% if constraints.time %}조리 시간: {{ constraints.time }}{% endif %}{% if constraints.difficulty %}, 난이도: {{ constraints.difficulty }}{% endif %}{% if constraints.servings %}, 인분: {{ constraints.servings }}인분{% endif %}
    {% endif %}
    {% if dietary %}
    식이 제한: {{ dietary | join(', ') }}
    {% endif %}

    다음 JSON 형식으로 레시피를 작성하세요. 다른 텍스트 없이 오직 JSON만 반환하세요:

    {
        "title": "요리 이름",
        "ingredients": ["재료1 (분량)", "재료2 (분량)", ...],
        "steps": ["1단계 설명", "2단계 설명", ...],
        "cooking_time": "예상 조리 시간 (예: 30분)",
        "difficulty": "난이도 (쉬움/중간/어려움 중 하나)"
    }

generate_recipe_multiple:
  description: "복수 레시피 생성"
  template: |
    사용자가 "{{ query }}"를 요청했습니다.

    {% if dishes %}
    요리명: {{ dishes | join(', ') }}
    {% endif %}
    {% if ingredients %}
    사용 재료: {{ ingredients | join(', ') }}
    {% endif %}
    {% if constraints %}
    제약 조건: {% if constraints.time %}조리 시간: {{ constraints.time }}{% endif %}{% if constraints.difficulty %}, 난이도: {{ constraints.difficulty }}{% endif %}{% if constraints.servings %}, 인분: {{ constraints.servings }}인분{% endif %}
    {% endif %}
    {% if dietary %}
    식이 제한: {{ dietary | join(', ') }}
    {% endif %}

    다음 JSON 배열 형식으로 {{ count }}개의 레시피를 작성하세요. 다른 텍스트 없이 오직 JSON만 반환하세요:

    [
        {
            "title": "요리 이름1",
            "ingredients": ["재료1 (분량)", "재료2 (분량)", ...],
            "steps": ["1단계 설명", "2단계 설명", ...],
            "cooking_time": "예상 조리 시간",
            "difficulty": "난이도 (쉬움/중간/어려움 중 하나)"
        },
        {
            "title": "요리 이름2",
            ...
        },
        ...
    ]

recommend_dishes:
  description: "음식 추천"
  template: |
    사용자가 "{{ query }}"를 요청했습니다.

    {% if cuisine_type or taste or ingredients or dietary or constraints %}
    요구사항:
    {% if cuisine_type %}
    - 요리 유형: {{ cuisine_type }}
    {% endif %}
    {% if taste %}
    - 맛 선호: {{ taste | join(', ') }}
    {% endif %}
    {% if ingredients %}
    - 활용 재료: {{ ingredients | join(', ') }}
    {% endif %}
    {% if dietary %}
    - 식이 제한: {{ dietary | join(', ') }}
    {% endif %}
    {% if constraints.time %}
    - 조리 시간: {{ constraints.time }}
    {% endif %}
    {% if constraints.difficulty %}
    - 난이도: {{ constraints.difficulty }}
    {% endif %}
    {% endif %}

    위 요구사항에 맞는 음식 {{ count }}가지를 추천하고, 각각에 대해 간단한 설명을 포함하세요.

    JSON 형식으로 반환:
    {
        "recommendations": [
            {"name": "음식 이름", "description": "간단한 설명", "reason": "추천 이유"},
            ...
        ]
    }

    ⚠️ 중요: 오직 name, description, reason 필드만 포함하세요. recipe, ingredients, steps 등 다른 필드는 절대 추가하지 마세요.

answer_question:
  description: "요리 관련 질문 답변"
  template: |
    사용자 질문: "{{ query }}"

    위 질문에 대해 정확하고 도움이 되는 답변을 제공하세요.
    요리, 재료, 영양, 조리법 등과 관련된 전문적인 답변을 작성하세요.

    JSON 형식으로 반환:
    {
        "answer": "답변 내용",
        "additional_tips": ["추가 팁1", "추가 팁2"]
    }
image_prompt:
  description: "Food photography prompt for image generation"
  template: |
    professional food photography of {{ dish_name }},
    appetizing, high quality, restaurant style,
    well plated, natural lighting, 4k resolution

# 🛒 마트 AI 레시피 추천 시스템

> 교육용 프로젝트 정리본
> 

---

## 📌 핵심 메시지

<aside>
💡

**"AI 도입한다고 ChatGPT 붙이면 되는 거 아냐?"**

실제로는 **누가 쓸 건지, 가이드를 어떻게 할 건지** 설계가 90%

</aside>

---

## 1. 프로젝트 개요

### 교육 목적

- **AI 프로그램 설계 흐름**: 의도파악 → 개체추출 → 처리분기 → 응답생성
- **레거시 DB 활용 흐름**: 기존 마트 시스템과 AI 연동 포인트

---

## 2. 생성형 AI vs 챗봇형 AI

| 구분 | 생성형 AI (GPT, Claude) | 챗봇형 AI |
| --- | --- | --- |
| 입력 | 자유 텍스트 | 버튼/선택지/가이드 |
| 흐름 | 예측 불가 | 시나리오 통제 |
| 사용자 | AI 잘 아는 사람 | 아무나 |
| 비즈니스 | 써먹기 어려움 | 대고객 서비스 가능 |

<aside>
✅

**결론**: 마트 고객/직원 대상 → **챗봇형 (가이드 있는 형태)** 필수

</aside>

---

## 3. 세 가지 시나리오

### 시나리오 1: 레시피 → 상품 매칭 ❌

**문제점**: 레시피의 "파스타면"을 어떤 상품으로 매칭할지 어려움

- 매칭 난이도: 상품 수십 개 중 뭘 보여줄지?
- 데이터 품질: 상품명이 제각각
- 유지보수: 상품 바뀔 때마다 매핑 깨짐

### 시나리오 2: 할인상품 기반 추천 ⭐ (권장)

**흐름**: 할인상품 목록 → 프롬프트 주입 → AI가 조합 추천

**예시 응답**:

> "들기름 비빔국수 어때요? 삼겹살도 30% 할인이라 같이 구우면 딱이에요!"
> 

**가치**:

- 고객: 할인 활용 + 메뉴 고민 해결
- 마트: 할인상품 소진 + 연관 구매 유도

### 시나리오 3: 냉장고 + 할인 연계 ⭐ (권장)

**흐름**: 냉장고 재료 입력 → 개체 추출 → 할인상품 조회 → 조합 추천

**예시 응답**:

> "삼겹살, 대파, 마늘 있으시네요! 제육볶음 어때요? 고추장이 지금 20% 할인이에요."
> 

**핵심**: 냉장고 재료 기반처럼 보이지만, **실제는 할인상품 기반 추가 구매 유도**

---

## 4. 시스템 아키텍처

### AI 프로그램 흐름

```
[사용자 입력]
    ↓
[의도 파악] ← "레시피 알려줘" vs "이걸로 뭐 만들지"
    ↓
[개체 추출] ← "삼겹살", "양파", "된장찌개"
    ↓
[처리 분기]
    ├── 레시피 생성 (LLM)
    ├── 상품 조회 (레거시 DB)
    └── 추천 로직
    ↓
[응답 생성]
```

### 역할 분리

| AI가 하는 것 | 레거시에서 가져오는 것 |
| --- | --- |
| 의도/개체 파악 | 현재 할인상품 목록 |
| 레시피 생성/추천 | 상품 → 식재료 매핑 |
| 자연어 응답 | 재고/가격 정보 |

---

## 5. 데이터 구조 설계

### 테이블 구조

```sql
-- 카테고리
CREATE TABLE category (
    category_code VARCHAR(10) PRIMARY KEY,
    large_category VARCHAR(50),   -- 대분류
    medium_category VARCHAR(50),  -- 중분류
    small_category VARCHAR(50)    -- 소분류
);

-- 상품 (마스터)
CREATE TABLE product (
    product_code VARCHAR(20) PRIMARY KEY,
    product_name VARCHAR(100),
    category_code VARCHAR(10),
    ingredient_name VARCHAR(50)  -- 식재료명 (레시피 연동용)
);

-- 바코드 (판매단위)
CREATE TABLE barcode (
    barcode VARCHAR(20) PRIMARY KEY,
    product_code VARCHAR(20),
    spec VARCHAR(50),            -- 규격 (500g, 1kg)
    price INT,
    discount_rate INT DEFAULT 0,
    is_promotion BOOLEAN DEFAULT FALSE
);
```

---

## 6. 개발 현황

### ✅ 완료 (LangChain 기반)

- [x]  의도 파악
- [x]  개체 추출
- [x]  레시피 생성
- [x]  요리 추천
- [x]  요리 관련 응답

### 📋 TODO: 백엔드

- [ ]  가상 데이터 생성 (상품, 카테고리, 할인상품)
- [ ]  상품 조회 API
- [ ]  할인상품 조회 API
- [ ]  LangChain ↔ 레거시 DB 연동 레이어
- [ ]  시나리오별 처리 로직

### 📋 TODO: 프론트엔드

- [ ]  메인 화면 (시나리오 선택)
- [ ]  시나리오별 입력 화면
- [ ]  채팅형 결과 화면
- [ ]  할인상품 표시 컴포넌트

---

## 7. UI 설계 (와이어프레임)

### 메인 화면

```
┌─────────────────────────────────┐
│      🍳 마트 AI 요리 도우미       │
├─────────────────────────────────┤
│   [🍝 레시피 검색]               │
│   [🏷️ 할인상품으로 뭐 해먹지?]   │
│   [🧊 냉장고 털기]               │
└─────────────────────────────────┘
```

### 할인상품 기반 화면

```
┌─────────────────────────────────┐
│ 🏷️ 오늘의 할인상품               │
│ 🔥 들기름 50%  🔥 삼겹살 30%     │
│ ☑ 들기름  ☐ 삼겹살  ☐ 고추장    │
│        [추천받기]               │
└─────────────────────────────────┘
```

### 결과 화면 (채팅형)

```
┌─────────────────────────────────┐
│ 🤖 삼겹살, 대파, 마늘 있으시네요! │
│    제육볶음 어때요?              │
│    🏷️ 고추장 20% → 2,400원      │
│    [📋 레시피 보기] [🛒 담기]    │
└─────────────────────────────────┘
```

---

## 8. 교육 시 강조 포인트

### 오해 vs 현실

| ❌ 오해 | ✅ 현실 |
| --- | --- |
| AI가 다 알아서 해줌 | 데이터는 레거시에서 가져옴 |
| 기존 시스템 갈아엎어야 함 | 연동만 하면 됨 |
| ChatGPT 붙이면 끝 | 시나리오 설계가 90% |
| 비전문가도 자유롭게 질문 | 가이드 없으면 못 씀 |

---

## 9. 기술 구현

### 프롬프트 관리 구조

**폴더 구조**:

```
prompts/
├── cooking_recipe/
│   └── getRecipe.yaml
├── discount/
│   └── recommend.yaml
└── fridge/
    └── suggest.yaml
```

**YAML 형식**:

```yaml
v1:
  system: |
    당신은 요리 전문가입니다.
  user: |
    {{ dish_name }} 레시피 알려주세요.
```

### LLM 인터페이스

```python
# llm/[base.py](http://base.py)
class BaseLLM(ABC):
    default_options = {"temperature": 0.7, "max_tokens": 1000}
    
    @abstractmethod
    def chat(self, prompt: str, options: dict = None) -> str:
        pass
```

### 프로젝트 구조

```
project/
├── docker-compose.yml
├── core/
│   ├── llm/          # LLM 인터페이스
│   └── database/     # DB 연결
└── app/
    ├── front/        # HTML 서빙
    ├── api/          # API 라우터
    └── workflow/     # 랭그래프 워크플로우
```

---

## 10. 참고 자료

### 데이터 소스

- **Open Food Facts**: https://world.openfoodfacts.org/data (CSV 다운로드 가능)
- **식약처 유통바코드**: API만 제공, 제한적
- **GS1 Korea**: 공식 바코드 데이터, 제휴 필요

<aside>
📝

**교육용 결론**: 가상 데이터로 구조만 보여주는 게 현실적

</aside>